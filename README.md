# Fitness Studio Booking API

A simple backend API to manage fitness class listings and bookings for a fictional fitness studio.
Built with **Flask** and **SQLite** for data storage.

---

## Project Overview

This API allows clients to:

* View upcoming fitness classes (Yoga, Zumba, HIIT, etc.)
* Book a spot in a class (with validation of available slots)
* View their bookings by email

---

##  File Structure & Description

```
.
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py          # Flask app factory, DB init, and Blueprint registration
â”‚   â”œâ”€â”€ models.py            # SQLAlchemy models: FitnessClass, Booking
â”‚   â”œâ”€â”€ routes.py            # API endpoints: /classes, /book, /bookings
â”‚   â”œâ”€â”€ utils.py             # Helper functions (timezone handling, validation)
â”‚   
â”‚
â”œâ”€â”€ instance/
â”‚   â””â”€â”€ booking.db           # SQLite DB file created on first run (used by SQLAlchemy)
â”‚
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ __init__.py          # Marks this directory as a Python module
â”‚   â””â”€â”€ test_routes.py       # Pytest test cases for API validation
â”‚
â”œâ”€â”€ .venv/                   # Virtual environment (excluded from version control)
|
â”‚
â”œâ”€â”€ main.py                  # Entry point to run the Flask app (`python main.py`)
â”œâ”€â”€ seed_data.py             # Script to create and seed the database with initial data
â”œâ”€â”€ requirements.txt         # Python dependencies
â”œâ”€â”€ README.md                # Project overview and documentation
â”œâ”€â”€ test.html                # HTML report generated by pytest-html

```

---

##  Setup Instructions

1. **Clone the repository**

```bash
git clone <repo_url>
cd <repo_name>
```

2. **Create and activate a virtual environment**

```bash
python -m venv .venv
# Windows
.venv\Scripts\activate
# macOS/Linux
source .venv/bin/activate
```

3. **Install dependencies**

```bash
pip install -r requirements.txt
```

4. **Initialize the database and seed data**

```bash
python app/seed_data.py
```

This will create `booking.db` and seed it with sample classes if none exist.

5. **Run the Flask app**

```bash
python run.py
```

The API will be available at `http://127.0.0.1:5000`

---

##  API Endpoints

| Endpoint    | Method | Description                                | Request Body / Query Params                     | Response Summary                              |
| ----------- | ------ | ------------------------------------------ | ----------------------------------------------- | --------------------------------------------- |
| `/classes`  | GET    | Get a list of all upcoming fitness classes | None                                            | JSON list of classes with details and slots   |
| `/book`     | POST   | Book a spot in a fitness class             | JSON: `class_id`, `client_name`, `client_email` | Success message or error if slots unavailable |
| `/bookings` | GET    | Get all bookings made by a client email    | Query param: `email`                            | JSON list of bookings for the email or error  |

---

### Detailed Endpoint Behavior

#### 1. GET `/classes`

* Returns a list of all fitness classes with fields:

  * `id`, `name`, `datetime` (in IST), `instructor`, `available_slots`
* Example Response:

```json
[
  {
    "id": 1,
    "name": "Yoga",
    "datetime": "2025-06-10T07:00:00+05:30",
    "instructor": "Aarti",
    "available_slots": 10
  },
  ...
]
```

#### 2. POST `/book`

* Request JSON example:

```json
{
  "class_id": 1,
  "client_name": "Shivani Rao",
  "client_email": "shivani@example.com"
}
```

* Validates:

  * All fields present
  * Class exists
  * Slots available (no overbooking)
* On success, reduces `available_slots` by 1 and returns:

```json
{
  "message": "Booking successful"
}
```

* On failure (e.g., missing fields, no slots), returns HTTP 400 with error message.

#### 3. GET `/bookings?email=...`

* Query parameter `email` is required.
* Returns all bookings made by the specified email.
* Example response:

```json
[
  {
    "booking_id": 5,
    "class_id": 1,
    "client_name": "Shivani Rao",
    "client_email": "shivani@example.com"
  }
]
```

* If no bookings found, returns HTTP 404 with error.

---

## ðŸ”§ Testing

Run automated tests using `pytest`:

```bash
pytest
```

Tests cover:

* Retrieving classes
* Booking validation (missing fields, overbooking)
* Fetching bookings by email

---

## Timezone Handling

* Classes are created/stored in **Indian Standard Time (IST)** timezone.
* The API returns datetime values in ISO 8601 format with IST timezone offset (`+05:30`).
* Timezone conversion is handled using `pytz` in the backend.

---

##  Error Handling & Validation

* Input fields are validated for presence and correct types.
* Attempts to book a full class return an error.
* Missing required fields return HTTP 400 with descriptive errors.



##  Sample cURL Requests

**Get classes:**

```bash
curl -X GET http://127.0.0.1:5000/classes
```

**Book a class:**

```bash
curl -X POST http://127.0.0.1:5000/book \
-H "Content-Type: application/json" \
-d '{"class_id":1,"client_name":"Shivani Rao","client_email":"shivani@example.com"}'
```

**Get bookings by email:**

```bash
curl -X GET "http://127.0.0.1:5000/bookings?email=shivani@example.com"
```

---

## ðŸŽ¥ Loom Video Walkthrough

[Watch the project walkthrough here]
(https://www.loom.com/share/d3c1f585f415486f834f51edaa269278?sid=bb79d37c-8300-4a68-b3c9-b6edb1a84027)
---

##  Notes

* Uses **SQLite** for lightweight persistent storage (`booking.db` file).
* Simple, modular Flask app with Blueprints and SQLAlchemy ORM.
* Designed for easy local development and testing.

---
